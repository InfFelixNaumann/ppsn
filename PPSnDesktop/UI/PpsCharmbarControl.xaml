<UserControl x:Class="TecWare.PPSn.UI.PpsCharmbarControl"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
			 xmlns:sys="clr-namespace:System;assembly=mscorlib"
 			 xmlns:ui="clr-namespace:TecWare.PPSn.UI;assembly=PPSn.Desktop.UI"
             xmlns:uiL="clr-namespace:TecWare.PPSn.UI"
             mc:Ignorable="d" 
			 x:Name="ppsnCharmbarControl"
             d:DesignHeight="300" d:DesignWidth="300">
	<UserControl.Resources>
		<Style x:Key="contentBorderStyle" TargetType="{x:Type Border}">
			<Setter Property="Background" Value="{StaticResource PPSnPopUpBackgroundBrush}"/>
			<Setter Property="BorderThickness" Value="1"/>
			<Setter Property="BorderBrush" Value="{StaticResource PPSnControlFocusedBorderBrush}"/>
			<Setter Property="RenderTransformOrigin">
				<Setter.Value>
					<Point X="1" Y="0.5"/>
				</Setter.Value>
			</Setter>
			<Setter Property="RenderTransform">
				<Setter.Value>
					<ScaleTransform ScaleX="0" ScaleY="1"/>
				</Setter.Value>
			</Setter>
			<Style.Triggers>
				<Trigger Property="Visibility" Value="Visible">
					<Trigger.EnterActions>
						<BeginStoryboard>
							<Storyboard>
								<DoubleAnimation Storyboard.TargetProperty="(RenderTransform).(ScaleTransform.ScaleX)" From="0" To="1" Duration="0:00:.2"/>
							</Storyboard>
						</BeginStoryboard>
					</Trigger.EnterActions>
				</Trigger>
			</Style.Triggers>
		</Style>

		<ControlTemplate x:Key="headerContentTemplate" TargetType="{x:Type ContentControl}">
			<Grid>
				<Grid.ColumnDefinitions>
					<ColumnDefinition/>
					<ColumnDefinition Width="40"/>
				</Grid.ColumnDefinitions>
				<Grid.RowDefinitions>
					<RowDefinition Height="40"/>
					<RowDefinition Height="16"/>
				</Grid.RowDefinitions>
				<TextBlock Grid.Column="0" Grid.Row="0" Margin="16,0,0,0"
						   Text="{TemplateBinding Content}"
						   Foreground="{StaticResource PPSnWindowForegroundBrush}"
						   VerticalAlignment="Center"
						   FontSize="18"/>
				<Button Grid.Column="1" Grid.Row="0" 
						Command="{x:Static uiL:PpsCharmbarControl.ChangeContentCommand}"
						Content="{StaticResource windowClosePathGeometry}"
						Foreground="{StaticResource PPSnWindowForegroundBrush}"
						Style="{StaticResource PPSnImageButtonStyle}">
					<Button.CommandParameter>
						<uiL:PPSnCharmbarContentType>Default</uiL:PPSnCharmbarContentType>
					</Button.CommandParameter>
				</Button>
			</Grid>
		</ControlTemplate>

		<!--no content to view-->
		<DataTemplate x:Key="emptyTemplate"/>

		<DataTemplate x:Key="noteTemplate">
			<Border Style="{StaticResource contentBorderStyle}">
				<Grid>
					<Grid.RowDefinitions>
						<RowDefinition Height="auto"/>
						<RowDefinition/>
					</Grid.RowDefinitions>
					<ContentControl Grid.Row="0" Content="Notizen" Template="{StaticResource headerContentTemplate}"/>
				</Grid>
			</Border>
		</DataTemplate>

		<DataTemplate x:Key="linkTemplate">
			<Border Style="{StaticResource contentBorderStyle}">
				<Grid>
					<Grid.RowDefinitions>
						<RowDefinition Height="auto"/>
						<RowDefinition/>
					</Grid.RowDefinitions>
					<ContentControl Grid.Row="0" Content="Verknüpfungen" Template="{StaticResource headerContentTemplate}"/>
                    <ListBox Grid.Row="1" ItemsSource="{Binding Links}">
                        <ListBox.ItemTemplate>
                            <ItemContainerTemplate>
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="75"/>
                                        <ColumnDefinition Width="75"/>
                                    </Grid.ColumnDefinitions>
                                    <Label Grid.Column="0" Content="{Binding LinkToId}"/>
                                    <Label Grid.Column="1" Content="{Binding LinkTo}"/>
                                </Grid>
                            </ItemContainerTemplate>
                        </ListBox.ItemTemplate>
                    </ListBox>
                </Grid>
			</Border>
		</DataTemplate>

		<DataTemplate x:Key="revisionTemplate">
			<Border Style="{StaticResource contentBorderStyle}">
				<Grid>
					<Grid.RowDefinitions>
						<RowDefinition Height="auto"/>
						<RowDefinition/>
					</Grid.RowDefinitions>
					<ContentControl Grid.Row="0" Content="Revisionierung" Template="{StaticResource headerContentTemplate}"/>
				</Grid>
			</Border>
		</DataTemplate>

		<DataTemplate x:Key="qmTemplate">
			<Border Style="{StaticResource contentBorderStyle}">
				<Grid>
					<Grid.RowDefinitions>
						<RowDefinition Height="auto"/>
						<RowDefinition/>
					</Grid.RowDefinitions>
					<ContentControl Grid.Row="0" Content="QM" Template="{StaticResource headerContentTemplate}"/>
				</Grid>
			</Border>
		</DataTemplate>

		<DataTemplate x:Key="tagTemplate">
			<Border Style="{StaticResource contentBorderStyle}">
				<Grid>
					<Grid.RowDefinitions>
						<RowDefinition Height="auto"/>
						<RowDefinition/>
                        <RowDefinition Height="150"/>
                    </Grid.RowDefinitions>
					<ContentControl Grid.Row="0" Content="Tags" Template="{StaticResource headerContentTemplate}"/>
                    <ListBox Grid.Row="1" ItemsSource="{Binding Tags}">
                        <ListBox.ItemTemplate>
                            <ItemContainerTemplate>
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="75"/>
                                        <ColumnDefinition Width="75"/>
                                        <ColumnDefinition Width="75"/>
                                    </Grid.ColumnDefinitions>
                                    <Label Grid.Column="0" Content="{Binding Name}"/>
                                    <Label Grid.Column="1" Content="{Binding Value}"/>
                                    <Label Grid.Column="2" Content="{Binding UserId}"/>
                                </Grid>
                            </ItemContainerTemplate>
                        </ListBox.ItemTemplate>
                    </ListBox>
                    <StackPanel Grid.Row="2">
                        <Label Content="Hinzufügen:"/>
                        <Label Content="Name:"/>
                        <TextBox Name="tbnewName"/>
                        <Label Content="Wert:"/>
                        <TextBox Name="tbnewValue"/>
                        <Button Content="Speichern" Command="{Binding AddTagCommand}"/>
                    </StackPanel>
                </Grid>
			</Border>
		</DataTemplate>

		<DataTemplate x:Key="taskTemplate">
			<Border Style="{StaticResource contentBorderStyle}">
				<Grid>
					<Grid.RowDefinitions>
						<RowDefinition Height="auto"/>
						<RowDefinition/>
					</Grid.RowDefinitions>
					<ContentControl Grid.Row="0" Content="Termine / Aufgaben" Template="{StaticResource headerContentTemplate}"/>
				</Grid>
			</Border>
		</DataTemplate>

		<Style x:Key="charmBarContentStyle" TargetType="ContentPresenter">
			<Setter Property="ContentTemplate" Value="{StaticResource emptyTemplate}"/>
			<Style.Triggers>
				<DataTrigger Binding="{Binding CurrentContentType, ElementName=ppsnCharmbarControl, Mode=OneWay}">
					<DataTrigger.Value>
						<uiL:PPSnCharmbarContentType>Note</uiL:PPSnCharmbarContentType>
					</DataTrigger.Value>
					<Setter Property="ContentTemplate" Value="{StaticResource noteTemplate}"/>
				</DataTrigger>
				<DataTrigger Binding="{Binding CurrentContentType, ElementName=ppsnCharmbarControl, Mode=OneWay}">
					<DataTrigger.Value>
						<uiL:PPSnCharmbarContentType>Link</uiL:PPSnCharmbarContentType>
					</DataTrigger.Value>
					<Setter Property="ContentTemplate" Value="{StaticResource linkTemplate}"/>
				</DataTrigger>
				<DataTrigger Binding="{Binding CurrentContentType, ElementName=ppsnCharmbarControl, Mode=OneWay}">
					<DataTrigger.Value>
						<uiL:PPSnCharmbarContentType>Revision</uiL:PPSnCharmbarContentType>
					</DataTrigger.Value>
					<Setter Property="ContentTemplate" Value="{StaticResource revisionTemplate}"/>
				</DataTrigger>
				<DataTrigger Binding="{Binding CurrentContentType, ElementName=ppsnCharmbarControl, Mode=OneWay}">
					<DataTrigger.Value>
						<uiL:PPSnCharmbarContentType>Qm</uiL:PPSnCharmbarContentType>
					</DataTrigger.Value>
					<Setter Property="ContentTemplate" Value="{StaticResource qmTemplate}"/>
				</DataTrigger>
				<DataTrigger Binding="{Binding CurrentContentType, ElementName=ppsnCharmbarControl, Mode=OneWay}">
					<DataTrigger.Value>
						<uiL:PPSnCharmbarContentType>Tag</uiL:PPSnCharmbarContentType>
					</DataTrigger.Value>
					<Setter Property="ContentTemplate" Value="{StaticResource tagTemplate}"/>
				</DataTrigger>
				<DataTrigger Binding="{Binding CurrentContentType, ElementName=ppsnCharmbarControl, Mode=OneWay}">
					<DataTrigger.Value>
						<uiL:PPSnCharmbarContentType>Task</uiL:PPSnCharmbarContentType>
					</DataTrigger.Value>
					<Setter Property="ContentTemplate" Value="{StaticResource taskTemplate}"/>
				</DataTrigger>
			</Style.Triggers>
		</Style>
	</UserControl.Resources>

	<Grid>
		<Grid.Style>
			<Style TargetType="{x:Type Grid}">
				<Setter Property="Margin" Value="0,0,0,0"/>
				<Style.Triggers>
					<DataTrigger Binding="{Binding CurrentPane.HasSideBar, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=uiL:PpsMainWindow, AncestorLevel=1}, Mode=OneWay}">
						<DataTrigger.Value>
							<sys:Boolean>True</sys:Boolean>
						</DataTrigger.Value>
						<Setter Property="Margin">
							<Setter.Value>
								<Thickness Left="{StaticResource PPSnSideBarIncreasedWidth}" Top="0" Right="0" Bottom="0"/>
							</Setter.Value>
						</Setter>
					</DataTrigger>
					<DataTrigger Binding="{Binding CurrentContentType, ElementName=ppsnCharmbarControl, Mode=OneWay}">
						<DataTrigger.Value>
							<uiL:PPSnCharmbarContentType>Default</uiL:PPSnCharmbarContentType>
						</DataTrigger.Value>
						<Setter Property="Width" Value="{StaticResource PPSnCharmBarColumnWidth}"/>
						<Setter Property="HorizontalAlignment" Value="Right"/>
					</DataTrigger>
				</Style.Triggers>
			</Style>
		</Grid.Style>
		<Grid.ColumnDefinitions>
			<ColumnDefinition Width="*"/>
			<!--Bindings do use type converters though-->
			<ColumnDefinition Width="{Binding Source={StaticResource PPSnCharmBarColumnWidth}, Mode=OneTime}"/>
		</Grid.ColumnDefinitions>
		<Grid.RowDefinitions>
			<RowDefinition/>
			<RowDefinition Height="48"/>
			<RowDefinition Height="48"/>
			<RowDefinition Height="48"/>
			<RowDefinition Height="48"/>
			<RowDefinition Height="48"/>
			<RowDefinition Height="48"/>
		</Grid.RowDefinitions>

		<Border Grid.Column="0" Grid.Row="0" Grid.RowSpan="7" MaxWidth="{StaticResource PPSnPaneMaxGridWidth}">
			<Border.Margin>
				<Thickness Left="{StaticResource PPSnPaneBorderSizeLeft}"
						   Top="0"
						   Right="{StaticResource PPSnPaneBorderSizeRight}"
						   Bottom="0"/>
			</Border.Margin>
			<Border.Style>
				<Style TargetType="{x:Type Border}">
					<Style.Triggers>
						<DataTrigger Binding="{Binding CurrentContentType, ElementName=ppsnCharmbarControl, Mode=OneWay}">
							<DataTrigger.Value>
								<uiL:PPSnCharmbarContentType>Default</uiL:PPSnCharmbarContentType>
							</DataTrigger.Value>
							<Setter Property="Visibility" Value="Collapsed"/>
						</DataTrigger>
					</Style.Triggers>
				</Style>
			</Border.Style>
			<ContentPresenter Content="{Binding}" Style="{StaticResource charmBarContentStyle}"/>
		</Border>

		<Button Grid.Column="1" Grid.Row="1" Margin="8" Command="{x:Static uiL:PpsCharmbarControl.ChangeContentCommand}">
			<Button.CommandParameter>
				<uiL:PPSnCharmbarContentType>Note</uiL:PPSnCharmbarContentType>
			</Button.CommandParameter>
		</Button>
		<Button Grid.Column="1" Grid.Row="2" Margin="8" Command="{x:Static uiL:PpsCharmbarControl.ChangeContentCommand}">
			<Button.CommandParameter>
				<uiL:PPSnCharmbarContentType>Link</uiL:PPSnCharmbarContentType>
			</Button.CommandParameter>
		</Button>
		<Button Grid.Column="1" Grid.Row="3" Margin="8" Command="{x:Static uiL:PpsCharmbarControl.ChangeContentCommand}">
			<Button.CommandParameter>
				<uiL:PPSnCharmbarContentType>Revision</uiL:PPSnCharmbarContentType>
			</Button.CommandParameter>
		</Button>
		<Button Grid.Column="1" Grid.Row="4" Margin="8" Command="{x:Static uiL:PpsCharmbarControl.ChangeContentCommand}">
			<Button.CommandParameter>
				<uiL:PPSnCharmbarContentType>Qm</uiL:PPSnCharmbarContentType>
			</Button.CommandParameter>
		</Button>
		<Button Grid.Column="1" Grid.Row="5" Margin="8" Command="{x:Static uiL:PpsCharmbarControl.ChangeContentCommand}">
			<Button.CommandParameter>
				<uiL:PPSnCharmbarContentType>Tag</uiL:PPSnCharmbarContentType>
			</Button.CommandParameter>
		</Button>
		<Button Grid.Column="1" Grid.Row="6" Margin="8" Command="{x:Static uiL:PpsCharmbarControl.ChangeContentCommand}">
			<Button.CommandParameter>
				<uiL:PPSnCharmbarContentType>Task</uiL:PPSnCharmbarContentType>
			</Button.CommandParameter>
		</Button>
	</Grid>
</UserControl>